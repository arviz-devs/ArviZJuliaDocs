<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../assets/default/flexsearch_integration.js" type="text/javascript"></script><script charset="utf-8" src="../../assets/hide_turing_menu.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Home · MCMCDiagnosticTools.jl</title><script data-outdated-warner="" src="assets/warner.js"></script><link href="nothing/MCMCDiagnosticTools/stable/" rel="canonical"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script data-main="assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="assets/themeswap.js"></script><link href="../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/><link href="../../assets/hide_turing_menu.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../.."><img alt="home" src="../../assets/logo.png"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../ArviZ/">ArviZ</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Plots</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../ArviZPythonPlots/">ArviZPythonPlots</a><a class="nav-link nav-item" href="../../ArviZPlots/dev/">ArviZPlots (unregistered)</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Stats</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../PosteriorStats/">PosteriorStats</a><a class="nav-link nav-item" href="../../PSIS/">PSIS</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Diagnostics</button><ul class="nav-dropdown-container"><a class="nav-link active nav-item" href="../">MCMCDiagnosticTools</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Data</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../InferenceObjects/">InferenceObjects</a><a class="nav-link nav-item" href="../../ArviZExampleData/">ArviZExampleData</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><style>
    html {
        scroll-padding-top: calc(55px + 1rem);
    }

    /* Documenter css tweaks */
    .docs-sidebar {
        margin-top: 3.75rem;
    }

    #documenter {
        margin-top: 3.75rem;
    }

    .docs-version-selector {
        margin-bottom: 60px !important;
    }

    @media screen and (max-width: 1056px) {
        .docs-version-selector {
            margin-bottom: 60px !important;
        }

        .docs-sidebar {
            margin-top: 0 !important;
        }
    }
    /* Documenter css tweaks ends here */

    :root {
        --heading-color: white;
        --item-color: rgb(165, 165, 165);
        --primary-bg: #073c44;
        --hover-color: #8faad2;
    }

    .ext-navigation {
        position: fixed;
        height: 3.75rem;
        top: 0;
        width: 100%;
        background-color: var(--primary-bg);
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        padding: 0 1.0625rem;
        transition: transform 0.3s;
    }

    .ext-navbar-logo {
        margin-left: 0.625rem;
    }

    .ext-nav-links {
        display: flex;
        align-items: center;
        list-style-type: none;
        margin: 0;
        padding: 0;
        flex-grow: 1;
    }

    .ext-nav-links li {
        margin-left: 1rem !important;
    }

    .ext-nav-link {
        color: white !important;
        text-decoration: none;
        font-size: 1.0625rem !important;
        transition: color 0.2s ease;
        cursor: pointer;
    }

    .ext-nav-link:hover,
    .ext-navbar-item-single a:hover {
        color: var(--hover-color) !important;
    }

    .ext-navbar-item-single a {
        color: #fff !important;
    }

    .ext-menu-toggle {
        display: none;
        font-size: 1.5rem;
        color: white;
        cursor: pointer;
    }

    .ext-dropdown {
        display: none;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        grid-template-rows: auto auto auto;
        padding: 1.875rem;
        position: absolute;
        width: 100%;
        left: 0;
        background-color: #083c44;
        line-height: 1.875rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        transform: translateY(-0.625rem);
    }

    #library-handler::after {
        content: "▼";
        font-size: 0.6875rem;
        margin-left: 0.3125rem;
        transition: transform 0.3s ease-in-out;
    }

    #library-handler.open::after {
        content: "▲";
    }

    .ext-dropdown.show {
        display: grid;
        opacity: 1;
        transform: translateY(0);
    }

    .ext-dropdown ul {
        height: auto;
        width: 12.5rem;
        margin-bottom: 1.25rem;
    }

    .ext-dropdown ul li {
        text-align: left;
    }

    .navbar-sub-item {
        list-style: none;
    }

    .ext-dropdown ul a li {
        color: var(--item-color);
        width: 15.625rem;
        border-radius: 3px;
        padding: 0.125rem 0.625rem;
        transition: background-color 0.2s ease;
    }

    .ext-dropdown ul a li:hover {
        background-color: rgba(107, 107, 107, 0.5);
    }

    .ext-dropdown-item-heading {
        color: var(--heading-color);
        text-align: center;
    }

    /* Responsive styling */
    @media (max-width: 966px) {
        .ext-dropdown {
            grid-template-columns: 1fr 1fr 1fr;
        }
    }

    @media (max-width: 768px) {
        .ext-nav-links {
            display: none;
            flex-direction: column;
            width: 100%;
            background-color: var(--primary-bg);
            position: absolute;
            top: 3.75rem;
            left: 0;
            padding: 0.625rem 0;
            height: auto;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgb(141, 141, 141) grey;
        }

        .ext-nav-links.show {
            display: flex;
        }

        .ext-nav-links li {
            margin: 0.625rem 0;
            text-align: center;
        }

        .ext-menu-toggle {
            display: block;
            margin-left: auto;
        }

        .ext-navigation.hide {
            transform: translateY(-3.75rem);
        }

        .ext-dropdown {
            place-content: center;
            text-align: center;
            grid-template-columns: 1fr;
            line-height: 1.25rem;
            padding: 0.625rem;
        }

        .ext-dropdown ul {
            width: 100%;
            text-align: center;
            margin-bottom: 0.3125rem;
        }

        .ext-dropdown ul li {
            text-align: center;
        }

        .ext-dropdown ul a li {
            width: 100%;
        }

        .ext-dropdown ul a li:hover {
            background-color: var(--primary-bg);
            color: #fff;
        }

        /* Modified scroll bar */
        .ext-nav-links::-webkit-scrollbar {
            width: 5px;
        }

        .ext-nav-links::-webkit-scrollbar-track {
            box-shadow: inset 0 0 5px grey;
        }

        .ext-nav-links::-webkit-scrollbar-thumb {
            background: rgb(141, 141, 141);
            border-radius: 3px;
        }

        .ext-nav-links::-webkit-scrollbar-thumb:hover {
            background: #9b9b9b;
        }
    }
</style><nav class="ext-navigation"><a href="https://turinglang.org/"><img alt="Turing Logo" class="ext-navbar-logo" height="24px" src="https://turinglang.org/assets/images/turing-logo.svg" width="40px"/></a><a href="https://turinglang.org/" style="color: white !important; font-size: 21.25px !important; margin-left: 10px;">Turing.jl</a><ul class="ext-nav-links"><li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/docs-00-getting-started/">Get Started</a></li><li><a class="ext-nav-link" href="https://turinglang.org/docs/tutorials/00-introduction/">Tutorials</a></li><li><p class="ext-nav-link" id="library-handler">Libraries</p><div class="ext-dropdown" id="ext-dropdown-items"><ul><li class="ext-dropdown-item-heading">Modelling Languages</li><a href="https://turinglang.org/DynamicPPL.jl/"><li>DynamicPPL</li></a><a href="https://turinglang.org/JuliaBUGS.jl/"><li>JuliaBUGS</li></a><a href="https://turinglang.org/TuringGLM.jl/"><li>TuringGLM</li></a></ul><ul><li class="ext-dropdown-item-heading">MCMC</li><a href="https://turinglang.org/AdvancedHMC.jl/"><li>AdvancedHMC</li></a><a href="https://turinglang.org/AbstractMCMC.jl/"><li>AbstractMCMC</li></a><a href="https://github.com/theogf/ThermodynamicIntegration.jl"><li>ThermodynamicIntegration</li></a><a href="https://turinglang.org/AdvancedPS.jl/"><li>AdvancedPS</li></a><a href="https://turinglang.org/SliceSampling.jl/"><li>SliceSampling</li></a><a href="https://turinglang.org/EllipticalSliceSampling.jl/"><li>EllipticalSliceSampling</li></a><a href="https://turinglang.org/NestedSamplers.jl/"><li>NestedSamplers</li></a></ul><ul><li class="ext-dropdown-item-heading">Diagnostics</li><a href="https://turinglang.org/MCMCChains.jl/"><li>MCMCChains</li></a><a href="https://turinglang.org/MCMCDiagnosticTools.jl/"><li>MCMCDiagnosticTools</li></a><a href="https://turinglang.org/ParetoSmooth.jl/"><li>ParetoSmooth</li></a></ul><ul><li class="ext-dropdown-item-heading">Gaussian Processes</li><a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/"><li>AbstractGPs</li></a><a href="https://juliagaussianprocesses.github.io/KernelFunctions.jl/"><li>KernelFunctions</li></a><a href="https://juliagaussianprocesses.github.io/ApproximateGPs.jl/"><li>ApproximateGPs</li></a></ul><ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/Bijectors.jl/">Bijectors</a></li></ul><ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringCallbacks.jl/">TuringCallbacks</a></li></ul><ul><li class="ext-dropdown-item-heading ext-navbar-item-single"><a href="https://turinglang.org/TuringBenchmarking.jl/">TuringBenchmarking</a></li></ul></div></li><li><a class="ext-nav-link" href="https://turinglang.org/news/">News</a></li><li><a class="ext-nav-link" href="https://turinglang.org/team/">Team</a></li></ul><a href="https://x.com/TuringLang" style="margin-left: 15px; padding-top: 2px"><svg fill="#ffffff" height="32px" space="preserve" stroke="#ffffff" version="1.1" viewBox="-209.92 -209.92 931.84 931.84" width="32px" xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><g id="7935ec95c421cee6d86eb22ecd12f847"><path d="M459.186,151.787c0.203,4.501,0.305,9.023,0.305,13.565 c0,138.542-105.461,298.285-298.274,298.285c-59.209,0-114.322-17.357-160.716-47.104c8.212,0.973,16.546,1.47,25.012,1.47 c49.121,0,94.318-16.759,130.209-44.884c-45.887-0.841-84.596-31.154-97.938-72.804c6.408,1.227,12.968,1.886,19.73,1.886 c9.55,0,18.816-1.287,27.617-3.68c-47.955-9.633-84.1-52.001-84.1-102.795c0-0.446,0-0.882,0.011-1.318 c14.133,7.847,30.294,12.562,47.488,13.109c-28.134-18.796-46.637-50.885-46.637-87.262c0-19.212,5.16-37.218,14.193-52.7 c51.707,63.426,128.941,105.156,216.072,109.536c-1.784-7.675-2.718-15.674-2.718-23.896c0-57.891,46.941-104.832,104.832-104.832 c30.173,0,57.404,12.734,76.525,33.102c23.887-4.694,46.313-13.423,66.569-25.438c-7.827,24.485-24.434,45.025-46.089,58.002 c21.209-2.535,41.426-8.171,60.222-16.505C497.448,118.542,479.666,137.004,459.186,151.787z" style="display: inline"></path></g></g></svg></a><a href="https://github.com/TuringLang/Turing.jl"><svg fill="#000000" height="32px" version="1.1" viewBox="-8.2 -8.2 36.40 36.40" width="32px" xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><title>github [#142]</title><desc>Created with Sketch.</desc><defs></defs><g fill="none" fill-rule="evenodd" id="Page-1" stroke-width="0.0002"><g fill="#ffffff" id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94,7399 C99.523,7399 104,7403.59 104,7409.253 C104,7413.782 101.138,7417.624 97.167,7418.981 C96.66,7419.082 96.48,7418.762 96.48,7418.489 C96.48,7418.151 96.492,7417.047 96.492,7415.675 C96.492,7414.719 96.172,7414.095 95.813,7413.777 C98.04,7413.523 100.38,7412.656 100.38,7408.718 C100.38,7407.598 99.992,7406.684 99.35,7405.966 C99.454,7405.707 99.797,7404.664 99.252,7403.252 C99.252,7403.252 98.414,7402.977 96.505,7404.303 C95.706,7404.076 94.85,7403.962 94,7403.958 C93.15,7403.962 92.295,7404.076 91.497,7404.303 C89.586,7402.977 88.746,7403.252 88.746,7403.252 C88.203,7404.664 88.546,7405.707 88.649,7405.966 C88.01,7406.684 87.619,7407.598 87.619,7408.718 C87.619,7412.646 89.954,7413.526 92.175,7413.785 C91.889,7414.041 91.63,7414.493 91.54,7415.156 C90.97,7415.418 89.522,7415.871 88.63,7414.304 C88.63,7414.304 88.101,7413.319 87.097,7413.247 C87.097,7413.247 86.122,7413.234 87.029,7413.87 C87.029,7413.87 87.684,7414.185 88.139,7415.37 C88.139,7415.37 88.726,7417.2 91.508,7416.58 C91.513,7417.437 91.522,7418.245 91.522,7418.489 C91.522,7418.76 91.338,7419.077 90.839,7418.982 C86.865,7417.627 84,7413.783 84,7409.253 C84,7403.59 88.478,7399 94,7399" id="github-[#142]"></path></g></g></g></g></svg></a><span class="ext-menu-toggle">☰</span></nav><script>
    document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.querySelector(".ext-menu-toggle");
        const navLinks = document.querySelector(".ext-nav-links");
        const nav = document.querySelector(".ext-navigation");
        const navigationHandler = document.getElementById("library-handler");
        const navigationItemsContainer =
            document.getElementById("ext-dropdown-items");
        let lastScrollY = window.scrollY;

        function setAppropriateHeight() {
            if (window.innerWidth <= 768) {
                const viewportHeight = window.innerHeight;
                const navHeight = nav.offsetHeight;
                navLinks.style.maxHeight = `${viewportHeight - navHeight}px`;
                navLinks.style.overflowY = "auto";
            } else {
                navLinks.style.maxHeight = "";
                navLinks.style.overflowY = "";
            }
        }

        // Toggle main menu for mobile
        menuToggle.addEventListener("click", () => {
            navLinks.classList.toggle("show");
            if (navLinks.classList.contains("show")) {
                setAppropriateHeight();
                // Ensure the dropdown is hidden when menu is first opened
                navigationItemsContainer.style.display = "none";
                navigationItemsContainer.classList.remove("show");
            }
        });

        // Close menus if clicked outside
        document.addEventListener("click", (event) => {
            if (
                !navLinks.contains(event.target) &&
                !menuToggle.contains(event.target)
            ) {
                navLinks.classList.remove("show");
                navigationItemsContainer.classList.remove("show");
                navigationHandler.classList.remove("open");
            }
        });

        // Hide navigation bar on scroll down in mobile view
        window.addEventListener("scroll", () => {
            if (window.innerWidth <= 768) {
                nav.classList.toggle("hide", window.scrollY > lastScrollY);
                lastScrollY = window.scrollY;
            }
        });

        // Library API script
        navigationHandler.addEventListener("click", (event) => {
            event.preventDefault(); // Prevent default action of the link
            if (navigationItemsContainer.classList.contains("show")) {
                navigationItemsContainer.classList.remove("show");
                navigationHandler.classList.remove("open");
                setTimeout(() => {
                    navigationItemsContainer.style.display = "none";
                }, 500); // Match the timeout to the CSS transition duration
            } else {
                navigationItemsContainer.style.display = "grid";
                navigationHandler.classList.add("open");
                setTimeout(() => {
                    navigationItemsContainer.classList.add("show");
                }, 10); // Delay to ensure the display change takes effect before adding class
            }
            setAppropriateHeight(); // Recalculate height when dropdown changes
        });

        // Handle window resize
        window.addEventListener("resize", setAppropriateHeight);

        // Initial setup
        setAppropriateHeight();
    });
</script><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="">MCMCDiagnosticTools.jl</a></span></div><form action="search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="">Home</a><ul class="internal"><li><a class="tocitem" href="#Effective-sample-size-and-potential-scale-reduction"><span>Effective sample size and potential scale reduction</span></a></li><li><a class="tocitem" href="#Monte-Carlo-standard-error"><span>Monte Carlo standard error</span></a></li><li><a class="tocitem" href="#R-diagnostic"><span>R⋆ diagnostic</span></a></li><li><a class="tocitem" href="#Bayesian-fraction-of-missing-information"><span>Bayesian fraction of missing information</span></a></li><li><a class="tocitem" href="#Other-diagnostics"><span>Other diagnostics</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="MCMCDiagnosticTools"><a class="docs-heading-anchor" href="#MCMCDiagnosticTools">MCMCDiagnosticTools</a><a id="MCMCDiagnosticTools-1"></a><a class="docs-heading-anchor-permalink" href="#MCMCDiagnosticTools" title="Permalink"></a></h1><h2 id="Effective-sample-size-and-potential-scale-reduction"><a class="docs-heading-anchor" href="#Effective-sample-size-and-potential-scale-reduction">Effective sample size and potential scale reduction</a><a id="Effective-sample-size-and-potential-scale-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Effective-sample-size-and-potential-scale-reduction" title="Permalink"></a></h2><p>The effective sample size (ESS) and the potential scale reduction can be estimated with <a href="#MCMCDiagnosticTools.ess_rhat"><code>ess_rhat</code></a>.</p><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.ess_rhat" id="MCMCDiagnosticTools.ess_rhat"><code>MCMCDiagnosticTools.ess_rhat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ess_rhat(
    samples::AbstractArray{&lt;:Union{Missing,Real},3}; method=ESSMethod(), maxlag=250
)</code></pre><p>Estimate the effective sample size and the potential scale reduction of the <code>samples</code> of shape <code>(draws, chains, parameters)</code> with the <code>method</code> and a maximum lag of <code>maxlag</code>.</p><p>See also: <a href="#MCMCDiagnosticTools.ESSMethod"><code>ESSMethod</code></a>, <a href="#MCMCDiagnosticTools.FFTESSMethod"><code>FFTESSMethod</code></a>, <a href="#MCMCDiagnosticTools.BDAESSMethod"><code>BDAESSMethod</code></a></p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/ess.jl#L198-L207" target="_blank">source</a></section></article><p>The following methods are supported:</p><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.ESSMethod" id="MCMCDiagnosticTools.ESSMethod"><code>MCMCDiagnosticTools.ESSMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ESSMethod &lt;: AbstractESSMethod</code></pre><p>The <code>ESSMethod</code> uses a standard algorithm for estimating the effective sample size of MCMC chains.</p><p>It is is based on the discussion by Vehtari et al. and uses the biased estimator of the autocovariance, as discussed by Geyer. In contrast to Geyer, the divisor <code>n - 1</code> is used in the estimation of the autocovariance to obtain the unbiased estimator of the variance for lag 0.</p><p><strong>References</strong></p><p>Geyer, C. J. (1992). Practical Markov Chain Monte Carlo. Statistical Science, 473-483.</p><p>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P. C. (2021). Rank-normalization, folding, and localization: An improved <span>$\widehat {R}$</span> for assessing convergence of MCMC. Bayesian Analysis.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/ess.jl#L4-L20" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.FFTESSMethod" id="MCMCDiagnosticTools.FFTESSMethod"><code>MCMCDiagnosticTools.FFTESSMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FFTESSMethod &lt;: AbstractESSMethod</code></pre><p>The <code>FFTESSMethod</code> uses a standard algorithm for estimating the effective sample size of MCMC chains.</p><p>The algorithm is the same as the one of <a href="#MCMCDiagnosticTools.ESSMethod"><code>ESSMethod</code></a> but this method uses fast Fourier transforms (FFTs) for estimating the autocorrelation.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>To be able to use this method, you have to load a package that implements the <a href="https://github.com/JuliaMath/AbstractFFTs.jl">AbstractFFTs.jl</a> interface such as <a href="https://github.com/JuliaMath/FFTW.jl">FFTW.jl</a> or <a href="https://github.com/JuliaApproximation/FastTransforms.jl">FastTransforms.jl</a>.</p></div></div></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/ess.jl#L23-L37" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.BDAESSMethod" id="MCMCDiagnosticTools.BDAESSMethod"><code>MCMCDiagnosticTools.BDAESSMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BDAESSMethod &lt;: AbstractESSMethod</code></pre><p>The <code>BDAESSMethod</code> uses a standard algorithm for estimating the effective sample size of MCMC chains.</p><p>It is is based on the discussion by Vehtari et al. and uses the variogram estimator of the autocorrelation function discussed by Gelman et al.</p><p><strong>References</strong></p><p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). Bayesian data analysis. CRC press.</p><p>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P. C. (2021). Rank-normalization, folding, and localization: An improved <span>$\widehat {R}$</span> for assessing convergence of MCMC. Bayesian Analysis.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/ess.jl#L40-L54" target="_blank">source</a></section></article><h2 id="Monte-Carlo-standard-error"><a class="docs-heading-anchor" href="#Monte-Carlo-standard-error">Monte Carlo standard error</a><a id="Monte-Carlo-standard-error-1"></a><a class="docs-heading-anchor-permalink" href="#Monte-Carlo-standard-error" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.mcse" id="MCMCDiagnosticTools.mcse"><code>MCMCDiagnosticTools.mcse</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mcse(x::AbstractVector{&lt;:Real}; method::Symbol=:imse, kwargs...)</code></pre><p>Compute the Monte Carlo standard error (MCSE) of samples <code>x</code>. The optional argument <code>method</code> describes how the errors are estimated. Possible options are:</p><ul><li><code>:bm</code> for batch means <sup class="footnote-reference"><a href="#footnote-Glynn1991" id="citeref-Glynn1991">[Glynn1991]</a></sup></li><li><code>:imse</code> initial monotone sequence estimator <sup class="footnote-reference"><a href="#footnote-Geyer1992" id="citeref-Geyer1992">[Geyer1992]</a></sup></li><li><code>:ipse</code> initial positive sequence estimator <sup class="footnote-reference"><a href="#footnote-Geyer1992" id="citeref-Geyer1992">[Geyer1992]</a></sup></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/mcse.jl#L1-L14" target="_blank">source</a></section></article><h2 id="R-diagnostic"><a class="docs-heading-anchor" href="#R-diagnostic">R⋆ diagnostic</a><a id="R-diagnostic-1"></a><a class="docs-heading-anchor-permalink" href="#R-diagnostic" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.rstar" id="MCMCDiagnosticTools.rstar"><code>MCMCDiagnosticTools.rstar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rstar(
    rng::Random.AbstractRNG=Random.default_rng(),
    classifier::MLJModelInterface.Supervised,
    samples,
    chain_indices::AbstractVector{Int};
    subset::Real=0.8,
    verbosity::Int=0,
)</code></pre><p>Compute the <span>$R^*$</span> convergence statistic of the table <code>samples</code> with the <code>classifier</code>.</p><p><code>samples</code> must be either an <code>AbstractMatrix</code>, an <code>AbstractVector</code>, or a table (i.e. implements the Tables.jl interface) whose rows are draws and whose columns are parameters.</p><p><code>chain_indices</code> indicates the chain ids of each row of <code>samples</code>.</p><p>This method supports ragged chains, i.e. chains of nonequal lengths.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/rstar.jl#L1-L20" target="_blank">source</a></section><section><div><pre><code class="nohighlight hljs">rstar(
    rng::Random.AbstractRNG=Random.default_rng(),
    classifier::MLJModelInterface.Supervised,
    samples::AbstractArray{&lt;:Real,3};
    subset::Real=0.8,
    verbosity::Int=0,
)</code></pre><p>Compute the <span>$R^*$</span> convergence statistic of the <code>samples</code> with the <code>classifier</code>.</p><p><code>samples</code> is an array of draws with the shape <code>(draws, chains, parameters)</code>.`</p><p>This implementation is an adaption of algorithms 1 and 2 described by Lambert and Vehtari.</p><p>The <code>classifier</code> has to be a supervised classifier of the MLJ framework (see the <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/list_of_supported_models/#model_list">MLJ documentation</a> for a list of supported models). It is trained with a <code>subset</code> of the samples. The training of the classifier can be inspected by adjusting the <code>verbosity</code> level.</p><p>If the classifier is deterministic, i.e., if it predicts a class, the value of the <span>$R^*$</span> statistic is returned (algorithm 1). If the classifier is probabilistic, i.e., if it outputs probabilities of classes, the scaled Poisson-binomial distribution of the <span>$R^*$</span> statistic is returned (algorithm 2).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The correctness of the statistic depends on the convergence of the <code>classifier</code> used internally in the statistic.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using MLJBase, MLJXGBoostInterface, Statistics

julia&gt; samples = fill(4.0, 100, 3, 2);</code></pre><p>One can compute the distribution of the <span>$R^*$</span> statistic (algorithm 2) with the probabilistic classifier.</p><pre><code class="language-julia-repl hljs">julia&gt; distribution = rstar(XGBoostClassifier(), samples);

julia&gt; isapprox(mean(distribution), 1; atol=0.1)
true</code></pre><p>For deterministic classifiers, a single <span>$R^*$</span> statistic (algorithm 1) is returned. Deterministic classifiers can also be derived from probabilistic classifiers by e.g. predicting the mode. In MLJ this corresponds to a pipeline of models.</p><pre><code class="language-julia-repl hljs">julia&gt; xgboost_deterministic = Pipeline(XGBoostClassifier(); operation=predict_mode);

julia&gt; value = rstar(xgboost_deterministic, samples);

julia&gt; isapprox(value, 1; atol=0.2)
true</code></pre><p><strong>References</strong></p><p>Lambert, B., &amp; Vehtari, A. (2020). <span>$R^*$</span>: A robust MCMC convergence diagnostic with uncertainty using decision tree classifiers.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/rstar.jl#L77-L140" target="_blank">source</a></section></article><h2 id="Bayesian-fraction-of-missing-information"><a class="docs-heading-anchor" href="#Bayesian-fraction-of-missing-information">Bayesian fraction of missing information</a><a id="Bayesian-fraction-of-missing-information-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-fraction-of-missing-information" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.bfmi" id="MCMCDiagnosticTools.bfmi"><code>MCMCDiagnosticTools.bfmi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bfmi(energy::AbstractVector{&lt;:Real}) -&gt; Real
bfmi(energy::AbstractMatrix{&lt;:Real}; dims::Int=1) -&gt; AbstractVector{&lt;:Real}</code></pre><p>Calculate the estimated Bayesian fraction of missing information (BFMI).</p><p>When sampling with Hamiltonian Monte Carlo (HMC), BFMI quantifies how well momentum resampling matches the marginal energy distribution.</p><p>The current advice is that values smaller than 0.3 indicate poor sampling. However, this threshold is provisional and may change. A BFMI value below the threshold often indicates poor adaptation of sampling parameters or that the target distribution has heavy tails that were not well explored by the Markov chain.</p><p>For more information, see Section 6.1 of <sup class="footnote-reference"><a href="#footnote-Betancourt2018" id="citeref-Betancourt2018">[Betancourt2018]</a></sup> or <sup class="footnote-reference"><a href="#footnote-Betancourt2016" id="citeref-Betancourt2016">[Betancourt2016]</a></sup> for a complete account.</p><p><code>energy</code> is either a vector of Hamiltonian energies of draws or a matrix of energies of draws for multiple chains. <code>dims</code> indicates the dimension in <code>energy</code> that contains the draws. The default <code>dims=1</code> assumes <code>energy</code> has the shape <code>draws</code> or <code>(draws, chains)</code>. If a different shape is provided, <code>dims</code> must be set accordingly.</p><p>If <code>energy</code> is a vector, a single BFMI value is returned. Otherwise, a vector of BFMI values for each chain is returned.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/bfmi.jl#L1-L34" target="_blank">source</a></section></article><h2 id="Other-diagnostics"><a class="docs-heading-anchor" href="#Other-diagnostics">Other diagnostics</a><a id="Other-diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Other-diagnostics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.discretediag" id="MCMCDiagnosticTools.discretediag"><code>MCMCDiagnosticTools.discretediag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">discretediag(samples::AbstractArray{&lt;:Real,3}; frac=0.3, method=:weiss, nsim=1_000)</code></pre><p>Compute discrete diagnostic on <code>samples</code> with shape <code>(draws, chains, parameters)</code>.</p><p><code>method</code> can be one of <code>:weiss</code>, <code>:hangartner</code>, <code>:DARBOOT</code>, <code>:MCBOOT</code>, <code>:billinsgley</code>, and <code>:billingsleyBOOT</code>.</p><p><strong>References</strong></p><p>Benjamin E. Deonovic, &amp; Brian J. Smith. (2017). Convergence diagnostics for MCMC draws of a categorical variable.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/discretediag.jl#L425-L436" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.gelmandiag" id="MCMCDiagnosticTools.gelmandiag"><code>MCMCDiagnosticTools.gelmandiag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gelmandiag(samples::AbstractArray{&lt;:Real,3}; alpha::Real=0.95)</code></pre><p>Compute the Gelman, Rubin and Brooks diagnostics <sup class="footnote-reference"><a href="#footnote-Gelman1992" id="citeref-Gelman1992">[Gelman1992]</a></sup><sup class="footnote-reference"><a href="#footnote-Brooks1998" id="citeref-Brooks1998">[Brooks1998]</a></sup> on <code>samples</code> with shape <code>(draws, chains, parameters)</code>.  Values of the diagnostic’s potential scale reduction factor (PSRF) that are close to one suggest convergence.  As a rule-of-thumb, convergence is rejected if the 97.5 percentile of a PSRF is greater than 1.2.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/gelmandiag.jl#L55-L67" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.gelmandiag_multivariate" id="MCMCDiagnosticTools.gelmandiag_multivariate"><code>MCMCDiagnosticTools.gelmandiag_multivariate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gelmandiag_multivariate(samples::AbstractArray{&lt;:Real,3}; alpha::Real=0.05)</code></pre><p>Compute the multivariate Gelman, Rubin and Brooks diagnostics on <code>samples</code> with shape <code>(draws, chains, parameters)</code>.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/gelmandiag.jl#L74-L79" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.gewekediag" id="MCMCDiagnosticTools.gewekediag"><code>MCMCDiagnosticTools.gewekediag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gewekediag(x::AbstractVector{&lt;:Real}; first::Real=0.1, last::Real=0.5, kwargs...)</code></pre><p>Compute the Geweke diagnostic <sup class="footnote-reference"><a href="#footnote-Geweke1991" id="citeref-Geweke1991">[Geweke1991]</a></sup> from the <code>first</code> and <code>last</code> proportion of samples <code>x</code>.</p><p>The diagnostic is designed to asses convergence of posterior means estimated with autocorrelated samples.  It computes a normal-based test statistic comparing the sample means in two windows containing proportions of the first and last iterations.  Users should ensure that there is sufficient separation between the two windows to assume that their samples are independent.  A non-significant test p-value indicates convergence.  Significant p-values indicate non-convergence and the possible need to discard initial samples as a burn-in sequence or to simulate additional samples.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/gewekediag.jl#L1-L16" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.heideldiag" id="MCMCDiagnosticTools.heideldiag"><code>MCMCDiagnosticTools.heideldiag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">heideldiag(
    x::AbstractVector{&lt;:Real}; alpha::Real=0.05, eps::Real=0.1, start::Int=1, kwargs...
)</code></pre><p>Compute the Heidelberger and Welch diagnostic <sup class="footnote-reference"><a href="#footnote-Heidelberger1983" id="citeref-Heidelberger1983">[Heidelberger1983]</a></sup>. This diagnostic tests for non-convergence (non-stationarity) and whether ratios of estimation interval halfwidths to means are within a target ratio. Stationarity is rejected (0) for significant test p-values. Halfwidth tests are rejected (0) if observed ratios are greater than the target, as is the case for <code>s2</code> and <code>beta[1]</code>.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/heideldiag.jl#L1-L13" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#MCMCDiagnosticTools.rafterydiag" id="MCMCDiagnosticTools.rafterydiag"><code>MCMCDiagnosticTools.rafterydiag</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rafterydiag(
    x::AbstractVector{&lt;:Real}; q=0.025, r=0.005, s=0.95, eps=0.001, range=1:length(x)
)</code></pre><p>Compute the Raftery and Lewis diagnostic <sup class="footnote-reference"><a href="#footnote-Raftery1992" id="citeref-Raftery1992">[Raftery1992]</a></sup>. This diagnostic is used to determine the number of iterations required to estimate a specified quantile <code>q</code> within a desired degree of accuracy.  The diagnostic is designed to determine the number of autocorrelated samples required to estimate a specified quantile <span>$\theta_q$</span>, such that <span>$\Pr(\theta \le \theta_q) = q$</span>, within a desired degree of accuracy. In particular, if <span>$\hat{\theta}_q$</span> is the estimand and <span>$\Pr(\theta \le \hat{\theta}_q) = \hat{P}_q$</span> the estimated cumulative probability, then accuracy is specified in terms of <code>r</code> and <code>s</code>, where <span>$\Pr(q - r &lt; \hat{P}_q &lt; q + r) = s$</span>. Thinning may be employed in the calculation of the diagnostic to satisfy its underlying assumptions. However, users may not want to apply the same (or any) thinning when estimating posterior summary statistics because doing so results in a loss of information. Accordingly, sample sizes estimated by the diagnostic tend to be conservative (too large).</p><p>Furthermore, the argument <code>r</code> specifies the margin of error for estimated cumulative probabilities and <code>s</code> the probability for the margin of error. <code>eps</code> specifies the tolerance within which the probabilities of transitioning from initial to retained iterations are within the equilibrium probabilities for the chain. This argument determines the number of samples to discard as a burn-in sequence and is typically left at its default value.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/MCMCDiagnosticTools.jl/blob/8d7435795164d0faeae2e3c83f94f125c214ebcc/src/rafterydiag.jl#L1-L26" target="_blank">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Glynn1991"><a class="tag is-link" href="#citeref-Glynn1991">Glynn1991</a>Glynn, P. W., &amp; Whitt, W. (1991). Estimating the asymptotic variance with batch means. Operations Research Letters, 10(8), 431-435.</li><li class="footnote" id="footnote-Geyer1992"><a class="tag is-link" href="#citeref-Geyer1992">Geyer1992</a>Geyer, C. J. (1992). Practical Markov Chain Monte Carlo. Statistical Science, 473-483.</li><li class="footnote" id="footnote-Betancourt2018"><a class="tag is-link" href="#citeref-Betancourt2018">Betancourt2018</a>Betancourt M. (2018). A Conceptual Introduction to Hamiltonian Monte Carlo. <a href="https://arxiv.org/pdf/1701.02434v2.pdf">arXiv:1701.02434v2</a> [stat.ME]</li><li class="footnote" id="footnote-Betancourt2016"><a class="tag is-link" href="#citeref-Betancourt2016">Betancourt2016</a>Betancourt M. (2016). Diagnosing Suboptimal Cotangent Disintegrations in Hamiltonian Monte Carlo. <a href="https://arxiv.org/pdf/1604.00695v1.pdf">arXiv:1604.00695v1</a> [stat.ME]</li><li class="footnote" id="footnote-Gelman1992"><a class="tag is-link" href="#citeref-Gelman1992">Gelman1992</a>Gelman, A., &amp; Rubin, D. B. (1992). Inference from iterative simulation using multiple sequences. Statistical science, 7(4), 457-472.</li><li class="footnote" id="footnote-Brooks1998"><a class="tag is-link" href="#citeref-Brooks1998">Brooks1998</a>Brooks, S. P., &amp; Gelman, A. (1998). General methods for monitoring convergence of iterative simulations. Journal of computational and graphical statistics, 7(4), 434-455.</li><li class="footnote" id="footnote-Geweke1991"><a class="tag is-link" href="#citeref-Geweke1991">Geweke1991</a>Geweke, J. F. (1991). Evaluating the accuracy of sampling-based approaches to the calculation of posterior moments (No. 148). Federal Reserve Bank of Minneapolis.</li><li class="footnote" id="footnote-Heidelberger1983"><a class="tag is-link" href="#citeref-Heidelberger1983">Heidelberger1983</a>Heidelberger, P., &amp; Welch, P. D. (1983). Simulation run length control in the presence of an initial transient. Operations Research, 31(6), 1109-1144.</li><li class="footnote" id="footnote-Raftery1992"><a class="tag is-link" href="#citeref-Raftery1992">Raftery1992</a>A L Raftery and S Lewis. Bayesian Statistics, chapter How Many Iterations in the Gibbs Sampler? Volume 4. Oxford University Press, New York, 1992.</li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 12 December 2022 23:26">Monday 12 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>