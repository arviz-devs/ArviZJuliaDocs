<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/hide_turing_menu.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>API · PosteriorStats.jl</title><meta content="API · PosteriorStats.jl" name="title"/><meta content="API · PosteriorStats.jl" property="og:title"/><meta content="API · PosteriorStats.jl" property="twitter:title"/><meta content="Documentation for PosteriorStats.jl." name="description"/><meta content="Documentation for PosteriorStats.jl." property="og:description"/><meta content="Documentation for PosteriorStats.jl." property="twitter:description"/><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/><link href="nothing/PosteriorStats/stable/api/" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/><link href="../../../assets/hide_turing_menu.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../.."><img alt="home" src="../../../assets/logo.png"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../ArviZ/">ArviZ</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Plots</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../ArviZPythonPlots/">ArviZPythonPlots</a><a class="nav-link nav-item" href="../../../ArviZPlots/dev/">ArviZPlots (unregistered)</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Stats</button><ul class="nav-dropdown-container"><a class="nav-link active nav-item" href="../../">PosteriorStats</a><a class="nav-link nav-item" href="../../../PSIS/">PSIS</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Diagnostics</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../MCMCDiagnosticTools/">MCMCDiagnosticTools</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Data</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../InferenceObjects/">InferenceObjects</a><a class="nav-link nav-item" href="../../../ArviZExampleData/">ArviZExampleData</a><a class="nav-link nav-item" href="https://rafaqz.github.io/DimensionalData.jl/" target="_blank">DimensionalData (external)</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PosteriorStats.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href="">API</a><ul class="internal"><li><a class="tocitem" href="#Summary-statistics"><span>Summary statistics</span></a></li><li><a class="tocitem" href="#Credible-intervals"><span>Credible intervals</span></a></li><li><a class="tocitem" href="#LOO-and-WAIC"><span>LOO and WAIC</span></a></li><li><a class="tocitem" href="#Model-comparison"><span>Model comparison</span></a></li><li><a class="tocitem" href="#Predictive-checks"><span>Predictive checks</span></a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/arviz-devs/PosteriorStats.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul></ul><h2 id="Summary-statistics"><a class="docs-heading-anchor" href="#Summary-statistics">Summary statistics</a><a id="Summary-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.SummaryStats" id="PosteriorStats.SummaryStats"><code>PosteriorStats.SummaryStats</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SummaryStats{D, V&lt;:(AbstractVector)}</code></pre><p>A container for a column table of values computed by <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>This object implements the Tables and TableTraits column table interfaces. It has a custom <code>show</code> method.</p><p><code>SummaryStats</code> behaves like an <code>OrderedDict</code> of columns, where the columns can be accessed using either <code>Symbol</code>s or a 1-based integer index.</p><ul><li><p><code>name::String</code>: The name of the collection of summary statistics, used as the table title in display.</p></li><li><p><code>data::Any</code>: The summary statistics for each parameter. It must implement the Tables interface.</p></li><li><p><code>parameter_names::AbstractVector</code>: Names of the parameters</p></li></ul><pre><code class="nohighlight hljs">SummaryStats([name::String,] data[, parameter_names])
SummaryStats(data[, parameter_names]; name::String="SummaryStats")</code></pre><p>Construct a <code>SummaryStats</code> from tabular <code>data</code> with optional stats <code>name</code> and <code>param_names</code>.</p><p><code>data</code> must not contain a column <code>:parameter</code>, as this is reserved for the parameter names, which are always in the first column.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/summarize.jl#L1" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.default_diagnostics" id="PosteriorStats.default_diagnostics"><code>PosteriorStats.default_diagnostics</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_diagnostics(focus=Statistics.mean; kwargs...)</code></pre><p>Default diagnostics to be computed with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>The value of <code>focus</code> determines the diagnostics to be returned:</p><ul><li><a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.mean"><code>Statistics.mean</code></a>: <code>mcse_mean</code>, <code>mcse_std</code>, <code>ess_tail</code>, <code>ess_bulk</code>, <code>rhat</code></li><li><a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.median"><code>Statistics.median</code></a>: <code>mcse_median</code>, <code>ess_tail</code>, <code>ess_bulk</code>, <code>rhat</code></li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/summarize.jl#L351-L359" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.default_stats" id="PosteriorStats.default_stats"><code>PosteriorStats.default_stats</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_stats(focus=Statistics.mean; prob_interval=0.94, kwargs...)</code></pre><p>Default statistics to be computed with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p><p>The value of <code>focus</code> determines the statistics to be returned:</p><ul><li><a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.mean"><code>Statistics.mean</code></a>: <code>mean</code>, <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.std"><code>std</code></a>, <code>hdi_94%</code></li><li><a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.median"><code>Statistics.median</code></a>: <code>median</code>, <a href="https://juliastats.org/StatsBase.jl/stable/scalarstats/#StatsBase.mad"><code>mad</code></a>, <code>eti_94%</code></li></ul><p>If <code>prob_interval</code> is set to a different value than the default, then different HDI and ETI statistics are computed accordingly. <a href="#PosteriorStats.hdi"><code>hdi</code></a> refers to the highest-density interval, while <a href="#PosteriorStats.eti"><code>eti</code></a> refers to the equal-tailed interval.</p><p>See also: <a href="#PosteriorStats.hdi"><code>hdi</code></a>, <a href="#PosteriorStats.eti"><code>eti</code></a></p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/summarize.jl#L312-L326" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.default_summary_stats" id="PosteriorStats.default_summary_stats"><code>PosteriorStats.default_summary_stats</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_summary_stats(focus=Statistics.mean; kwargs...)</code></pre><p>Combinatiton of <a href="#PosteriorStats.default_stats"><code>default_stats</code></a> and <a href="#PosteriorStats.default_diagnostics"><code>default_diagnostics</code></a> to be used with <a href="#PosteriorStats.summarize"><code>summarize</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/summarize.jl#L302-L307" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.summarize" id="PosteriorStats.summarize"><code>PosteriorStats.summarize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">summarize(data, stats_funs...; name="SummaryStats", [var_names]) -&gt; SummaryStats</code></pre><p>Compute the summary statistics in <code>stats_funs</code> on each param in <code>data</code>.</p><p><code>stats_funs</code> is a collection of functions that reduces a matrix with shape <code>(draws, chains)</code> to a scalar or a collection of scalars. Alternatively, an item in <code>stats_funs</code> may be a <code>Pair</code> of the form <code>name =&gt; fun</code> specifying the name to be used for the statistic or of the form <code>(name1, ...) =&gt; fun</code> when the function returns a collection. When the function returns a collection, the names in this latter format must be provided.</p><p>If no stats functions are provided, then those specified in <a href="#PosteriorStats.default_summary_stats"><code>default_summary_stats</code></a> are computed.</p><p><code>var_names</code> specifies the names of the parameters in <code>data</code>. If not provided, the names are inferred from <code>data</code>.</p><p>To support computing summary statistics from a custom object, overload this method specifying the type of <code>data</code>.</p><p>See also <a href="#PosteriorStats.SummaryStats"><code>SummaryStats</code></a>, <a href="#PosteriorStats.default_summary_stats"><code>default_summary_stats</code></a>, <a href="#PosteriorStats.default_stats"><code>default_stats</code></a>, <a href="#PosteriorStats.default_diagnostics"><code>default_diagnostics</code></a>.</p><p><strong>Examples</strong></p><p>Compute <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.mean"><code>Statistics.mean</code></a>, <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.std"><code>Statistics.std</code></a> and the Monte Carlo standard error (MCSE) of the mean estimate:</p><pre><code class="language-julia-repl hljs">julia&gt; using Statistics, StatsBase

julia&gt; x = randn(1000, 4, 3) .+ reshape(0:10:20, 1, 1, :);

julia&gt; summarize(x, mean, std, :mcse_mean =&gt; sem; name="Mean/Std")
Mean/Std
       mean    std  mcse_mean
 1   0.0003  0.989      0.016
 2  10.02    0.988      0.016
 3  19.98    0.988      0.016</code></pre><p>Avoid recomputing the mean by using <a href="https://juliastats.org/StatsBase.jl/stable/scalarstats/#StatsBase.mean_and_std"><code>StatsBase.mean_and_std</code></a>, and provide parameter names:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, (:mean, :std) =&gt; mean_and_std, mad; var_names=[:a, :b, :c])
SummaryStats
         mean    std    mad
 a   0.000275  0.989  0.978
 b  10.0       0.988  0.995
 c  20.0       0.988  0.979</code></pre><p>Note that when an estimator and its MCSE are both computed, the MCSE is used to determine the number of significant digits that will be displayed.</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x; var_names=[:a, :b, :c])
SummaryStats
       mean   std  hdi_94%        mcse_mean  mcse_std  ess_tail  ess_bulk  rha ⋯
 a   0.0003  0.99  -1.92 .. 1.78      0.016     0.012      3567      3663  1.0 ⋯
 b  10.02    0.99   8.17 .. 11.9      0.016     0.011      3841      3906  1.0 ⋯
 c  19.98    0.99   18.1 .. 21.9      0.016     0.012      3892      3749  1.0 ⋯
                                                                1 column omitted</code></pre><p>Compute just the statistics with an 89% HDI on all parameters, and provide the parameter names:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, default_stats(; prob_interval=0.89)...; var_names=[:a, :b, :c])
SummaryStats
         mean    std  hdi_89%
 a   0.000275  0.989  -1.63 .. 1.52
 b  10.0       0.988   8.53 .. 11.6
 c  20.0       0.988   18.5 .. 21.6</code></pre><p>Compute the summary stats focusing on <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.median"><code>Statistics.median</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; summarize(x, default_summary_stats(median)...; var_names=[:a, :b, :c])
SummaryStats
    median    mad  eti_94%        mcse_median  ess_tail  ess_median  rhat
 a   0.004  0.978  -1.83 .. 1.89        0.020      3567        3336  1.00
 b  10.02   0.995   8.17 .. 11.9        0.023      3841        3787  1.00
 c  19.99   0.979   18.1 .. 21.9        0.020      3892        3829  1.00</code></pre><p>Compute multiple <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.quantile">quantiles</a> simultaneously:</p><pre><code class="language-julia-repl hljs">julia&gt; qs = (0.05, 0.25, 0.5, 0.75, 0.95);

julia&gt; summarize(x, (:q5, :q25, :q50, :q75, :q95) =&gt; Base.Fix2(Statistics.quantile, qs))
SummaryStats
       q5     q25       q50     q75    q95
 1  -1.61  -0.668   0.00447   0.653   1.64
 2   8.41   9.34   10.0      10.7    11.6
 3  18.4   19.3    20.0      20.6    21.6</code></pre></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/summarize.jl#L162-L262" target="_blank">source</a></section></article><h2 id="Credible-intervals"><a class="docs-heading-anchor" href="#Credible-intervals">Credible intervals</a><a id="Credible-intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Credible-intervals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.hdi" id="PosteriorStats.hdi"><code>PosteriorStats.hdi</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdi(samples::AbstractVecOrMat{&lt;:Real}; [prob, sorted, method]) -&gt; IntervalSets.ClosedInterval
hdi(samples::AbstractArray{&lt;:Real}; [prob, sorted, method]) -&gt; Array{&lt;:IntervalSets.ClosedInterval}</code></pre><p>Estimate the highest density interval (HDI) of <code>samples</code> for the probability <code>prob</code>.</p><p>The HDI is the minimum width Bayesian credible interval (BCI). That is, it is the smallest possible interval containing <code>(100*prob)</code>% of the probability mass.[<a href="../references/#Hyndman1996">1</a>] This implementation uses the algorithm of <a href="../references/#ChenShao1999">Chen and Shao [2]</a>.</p><p>See also: <a href="#PosteriorStats.hdi!"><code>hdi!</code></a>, <a href="#PosteriorStats.eti"><code>eti</code></a>, <a href="#PosteriorStats.eti!"><code>eti!</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: an array of shape <code>(draws[, chains[, params...]])</code>. If multiple parameters are   present, a marginal HDI is computed for each.</li></ul><p><strong>Keywords</strong></p><ul><li><code>prob</code>: the probability mass to be contained in the HDI. Default is   <code>0.94</code>.</li><li><code>sorted=false</code>: if <code>true</code>, the input samples are assumed to be sorted.</li><li><code>method::Symbol</code>: the method used to estimate the HDI. Available options are:<ul><li><code>:unimodal</code>: Assumes a unimodal distribution (default). Bounds are entries in <code>samples</code>.</li><li><code>:multimodal</code>: Fits a density estimator to <code>samples</code> and finds the HDI of the estimated   density. For continuous data, the density estimator is a kernel density estimate (KDE)   computed using <a href="#PosteriorStats.kde_reflected"><code>kde_reflected</code></a>. For discrete data, a histogram with bin width   1 is used.</li><li><code>:multimodal_sample</code>: Like <code>:multimodal</code>, but uses the density estimator to find the   entries in <code>samples</code> with the highest density and computes the HDI from those points.   This can correct for inaccuracies in the density estimator.</li></ul></li><li><code>is_discrete::Union{Bool,Nothing}=nothing</code>: Specify if the data is discrete   (integer-valued). If <code>nothing</code>, it's automatically determined.</li><li><code>kwargs</code>: For continuous data and multimodal <code>method</code>s, remaining keywords are forwarded   to <a href="#PosteriorStats.kde_reflected"><code>kde_reflected</code></a>.</li></ul><p><strong>Returns</strong></p><ul><li><code>intervals</code>: If <code>samples</code> is a vector or matrix, then a single   <a href="https://juliamath.github.io/IntervalSets.jl/stable/api/#IntervalSets.ClosedInterval"><code>IntervalSets.ClosedInterval</code></a> is returned for <code>:unimodal</code> method, or a vector   of <code>ClosedInterval</code> for multimodal methods. For higher dimensional inputs, an array with   the shape <code>(params...,)</code> is returned, containing marginal HDIs for each parameter.</li></ul><div class="admonition is-info" id="Note-4ca7da4ce2d5b91"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4ca7da4ce2d5b91" title="Permalink"></a></header><div class="admonition-body"><p>Any default value of <code>prob</code> is arbitrary. The default value of <code>prob=0.94</code> instead of a more common default like <code>prob=0.95</code> is chosen to remind the user of this arbitrariness.</p></div></div><p><strong>Examples</strong></p><p>Here we calculate the 83% HDI for a normal random variable:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(2_000);

julia&gt; hdi(x; prob=0.83)
-1.3826605224220527 .. 1.259817149822839</code></pre><p>We can also calculate the HDI for a 3-dimensional array of samples:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(1_000, 1, 1) .+ reshape(0:5:10, 1, 1, :);

julia&gt; hdi(x)
3-element Vector{IntervalSets.ClosedInterval{Float64}}:
 -1.6402043796029502 .. 2.041852066407182
 3.35979562039705 .. 7.041852066407182
 8.35979562039705 .. 12.041852066407182</code></pre><p>For multimodal distributions, you can use the <code>:multimodal</code> method:</p><pre><code class="language-julia-repl hljs">julia&gt; x = vcat(randn(1000), randn(1000) .+ 5);

julia&gt; hdi(x; method=:multimodal)
2-element Vector{IntervalSets.ClosedInterval{Float64}}:
 -1.8882401079608677 .. 2.0017686164555037
 2.9839268475847436 .. 6.9235952578447275</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Hyndman1996">1</a>] Hyndman, J. Comput. Graph. Stat., 50:2 (1996)</li><li>[<a href="../references/#ChenShao1999">2</a>] Chen &amp; Shao, J Comput. Graph. Stat., 8:1 (1999)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/hdi.jl#L78-L161" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.hdi!" id="PosteriorStats.hdi!"><code>PosteriorStats.hdi!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdi!(samples::AbstractArray{&lt;:Real}; [prob, sorted])</code></pre><p>A version of <a href="#PosteriorStats.hdi"><code>hdi</code></a> that partially sorts <code>samples</code> in-place while computing the HDI.</p><p>See also: <a href="#PosteriorStats.hdi"><code>hdi</code></a>, <a href="#PosteriorStats.eti"><code>eti</code></a>, <a href="#PosteriorStats.eti!"><code>eti!</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/hdi.jl#L167-L173" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.eti" id="PosteriorStats.eti"><code>PosteriorStats.eti</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eti(samples::AbstractVecOrMat{&lt;:Real}; [prob, kwargs...]) -&gt; IntervalSets.ClosedInterval
eti(samples::AbstractArray{&lt;:Real}; [prob, kwargs...]) -&gt; Array{&lt;:IntervalSets.ClosedInterval}</code></pre><p>Estimate the equal-tailed interval (ETI) of <code>samples</code> for the probability <code>prob</code>.</p><p>The ETI of a given probability is the credible interval wih the property that the probability of being below the interval is equal to the probability of being above it. That is, it is defined by the <code>(1-prob)/2</code> and <code>1 - (1-prob)/2</code><a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.quantile">quantiles</a> of the samples.</p><p>See also: <a href="#PosteriorStats.eti!"><code>eti!</code></a>, <a href="#PosteriorStats.hdi"><code>hdi</code></a>, <a href="#PosteriorStats.hdi!"><code>hdi!</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>samples</code>: an array of shape <code>(draws[, chains[, params...]])</code>. If multiple parameters are   present</li></ul><p><strong>Keywords</strong></p><ul><li><code>prob</code>: the probability mass to be contained in the ETI. Default is   <code>0.94</code>.</li><li><code>kwargs</code>: remaining keywords are passed to <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.quantile"><code>Statistics.quantile</code></a>.</li></ul><p><strong>Returns</strong></p><ul><li><code>intervals</code>: If <code>samples</code> is a vector or matrix, then a single   <a href="https://juliamath.github.io/IntervalSets.jl/stable/api/#IntervalSets.ClosedInterval"><code>IntervalSets.ClosedInterval</code></a> is returned. Otherwise, an array with the shape   <code>(params...,)</code>, is returned, containing a marginal ETI for each parameter.</li></ul><div class="admonition is-info" id="Note-29594ae9440e24af"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-29594ae9440e24af" title="Permalink"></a></header><div class="admonition-body"><p>Any default value of <code>prob</code> is arbitrary. The default value of <code>prob=0.94</code> instead of a more common default like <code>prob=0.95</code> is chosen to reminder the user of this arbitrariness.</p></div></div><p><strong>Examples</strong></p><p>Here we calculate the 83% ETI for a normal random variable:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(2_000);

julia&gt; eti(x; prob=0.83)
-1.3740585250299766 .. 1.2860771129421198</code></pre><p>We can also calculate the ETI for a 3-dimensional array of samples:</p><pre><code class="language-julia-repl hljs">julia&gt; x = randn(1_000, 1, 1) .+ reshape(0:5:10, 1, 1, :);

julia&gt; eti(x)
3-element Vector{IntervalSets.ClosedInterval{Float64}}:
 -1.951006825019686 .. 1.9011666217153793
 3.048993174980314 .. 6.9011666217153795
 8.048993174980314 .. 11.90116662171538</code></pre></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/eti.jl#L1-L55" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.eti!" id="PosteriorStats.eti!"><code>PosteriorStats.eti!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eti!(samples::AbstractArray{&lt;:Real}; [prob, kwargs...])</code></pre><p>A version of <a href="#PosteriorStats.eti"><code>eti</code></a> that partially sorts <code>samples</code> in-place while computing the ETI.</p><p>See also: <a href="#PosteriorStats.eti"><code>eti</code></a>, <a href="#PosteriorStats.hdi"><code>hdi</code></a>, <a href="#PosteriorStats.hdi!"><code>hdi!</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/eti.jl#L65-L71" target="_blank">source</a></section></article><h2 id="LOO-and-WAIC"><a class="docs-heading-anchor" href="#LOO-and-WAIC">LOO and WAIC</a><a id="LOO-and-WAIC-1"></a><a class="docs-heading-anchor-permalink" href="#LOO-and-WAIC" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.AbstractELPDResult" id="PosteriorStats.AbstractELPDResult"><code>PosteriorStats.AbstractELPDResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractELPDResult</code></pre><p>An abstract type representing the result of an ELPD computation.</p><p>Every subtype stores estimates of both the expected log predictive density (<code>elpd</code>) and the effective number of parameters <code>p</code>, as well as standard errors and pointwise estimates of each, from which other relevant estimates can be computed.</p><p>Subtypes implement the following functions:</p><ul><li><a href="#PosteriorStats.elpd_estimates"><code>elpd_estimates</code></a></li><li><a href="#PosteriorStats.information_criterion"><code>information_criterion</code></a></li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/elpdresult.jl#L1" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.PSISLOOResult" id="PosteriorStats.PSISLOOResult"><code>PosteriorStats.PSISLOOResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Results of Pareto-smoothed importance sampling leave-one-out cross-validation (PSIS-LOO).</p><p>See also: <a href="#PosteriorStats.loo"><code>loo</code></a>, <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a></p><ul><li><p><code>estimates</code>: Estimates of the expected log pointwise predictive density (ELPD) and effective number of parameters (p)</p></li><li><p><code>pointwise</code>: Pointwise estimates</p></li><li><p><code>psis_result</code>: A <a href="https://julia.arviz.org/PSIS/stable/api/#PSIS.PSISResult"><code>PSIS.PSISResult</code></a> with Pareto-smoothed importance sampling (PSIS) results</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/loo.jl#L1" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.WAICResult" id="PosteriorStats.WAICResult"><code>PosteriorStats.WAICResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Results of computing the widely applicable information criterion (WAIC).</p><p>See also: <a href="#PosteriorStats.waic"><code>waic</code></a>, <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a></p><ul><li><p><code>estimates</code>: Estimates of the expected log pointwise predictive density (ELPD) and effective number of parameters (p)</p></li><li><p><code>pointwise</code>: Pointwise estimates</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/waic.jl#L1" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.elpd_estimates" id="PosteriorStats.elpd_estimates"><code>PosteriorStats.elpd_estimates</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">elpd_estimates(result::AbstractELPDResult; pointwise=false) -&gt; (; elpd, se_elpd, lpd)</code></pre><p>Return the (E)LPD estimates from the <code>result</code>.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/elpdresult.jl#L25-L29" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.information_criterion" id="PosteriorStats.information_criterion"><code>PosteriorStats.information_criterion</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">information_criterion(elpd, scale::Symbol)</code></pre><p>Compute the information criterion for the given <code>scale</code> from the <code>elpd</code> estimate.</p><p><code>scale</code> must be one of <code>(:deviance, :log, :negative_log)</code>.</p><p>See also: <a href="#PosteriorStats.loo"><code>loo</code></a>, <a href="#PosteriorStats.waic"><code>waic</code></a></p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/elpdresult.jl#L32-L40" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">information_criterion(result::AbstractELPDResult, scale::Symbol; pointwise=false)</code></pre><p>Compute information criterion for the given <code>scale</code> from the existing ELPD <code>result</code>.</p><p><code>scale</code> must be one of <code>(:deviance, :log, :negative_log)</code>.</p><p>If <code>pointwise=true</code>, then pointwise estimates are returned.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/elpdresult.jl#L46-L54" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.loo" id="PosteriorStats.loo"><code>PosteriorStats.loo</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loo(log_likelihood; reff=nothing, kwargs...) -&gt; PSISLOOResult{&lt;:NamedTuple,&lt;:NamedTuple}</code></pre><p>Compute the Pareto-smoothed importance sampling leave-one-out cross-validation (PSIS-LOO). [<a href="../references/#Vehtari2017">3</a>, <a href="../references/#LOOFAQ">4</a>]</p><p><code>log_likelihood</code> must be an array of log-likelihood values with shape <code>(chains, draws[, params...])</code>.</p><p><strong>Keywords</strong></p><ul><li><code>reff::Union{Real,AbstractArray{&lt;:Real}}</code>: The relative effective sample size(s) of the <em>likelihood</em> values. If an array, it must have the same data dimensions as the corresponding log-likelihood variable. If not provided, then this is estimated using <a href="https://julia.arviz.org/MCMCDiagnosticTools/stable/#MCMCDiagnosticTools.ess"><code>MCMCDiagnosticTools.ess</code></a>.</li><li><code>kwargs</code>: Remaining keywords are forwarded to <a href="https://julia.arviz.org/PSIS/stable/api/#PSIS.psis"><code>PSIS.psis</code></a>.</li></ul><p>See also: <a href="#PosteriorStats.PSISLOOResult"><code>PSISLOOResult</code></a>, <a href="#PosteriorStats.waic"><code>waic</code></a></p><p><strong>Examples</strong></p><p>Manually compute <span>$R_\mathrm{eff}$</span> and calculate PSIS-LOO of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData, MCMCDiagnosticTools

julia&gt; idata = load_example_data("centered_eight");

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; reff = ess(log_like; kind=:basic, split_chains=1, relative=true);

julia&gt; loo(log_like; reff)
PSISLOOResult with estimates
 elpd  se_elpd    p  se_p
  -31      1.4  0.9  0.33

and PSISResult with 500 draws, 4 chains, and 8 parameters
Pareto shape (k) diagnostic values:
                    Count      Min. ESS
 (-Inf, 0.5]  good  5 (62.5%)  290
  (0.5, 0.7]  okay  3 (37.5%)  399</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Vehtari2017">3</a>] Vehtari et al. Stat. Comput. 27 (2017).</li><li>[<a href="../references/#LOOFAQ">4</a>] Vehtari. Cross-validation FAQ.</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/loo.jl#L32-L80" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.waic" id="PosteriorStats.waic"><code>PosteriorStats.waic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waic(log_likelihood::AbstractArray) -&gt; WAICResult{&lt;:NamedTuple,&lt;:NamedTuple}</code></pre><p>Compute the widely applicable information criterion (WAIC). [<a href="../references/#Watanabe2010">5</a>]</p><p><code>log_likelihood</code> must be an array of log-likelihood values with shape <code>(chains, draws[, params...])</code>.</p><p>See also: <a href="#PosteriorStats.WAICResult"><code>WAICResult</code></a>, <a href="#PosteriorStats.loo"><code>loo</code></a></p><p><strong>Examples</strong></p><p>Calculate WAIC of a model:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data("centered_eight");

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; waic(log_like)
WAICResult with estimates
 elpd  se_elpd    p  se_p
  -31      1.4  0.9  0.32</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Watanabe2010">5</a>] Watanabe, JMLR 11(116) (2010)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/waic.jl#L26-L56" target="_blank">source</a></section></article><h2 id="Model-comparison"><a class="docs-heading-anchor" href="#Model-comparison">Model comparison</a><a id="Model-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Model-comparison" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.ModelComparisonResult" id="PosteriorStats.ModelComparisonResult"><code>PosteriorStats.ModelComparisonResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ModelComparisonResult</code></pre><p>Result of model comparison using ELPD.</p><p>This struct implements the Tables and TableTraits interfaces.</p><p>Each field returns a collection of the corresponding entry for each model:</p><ul><li><p><code>name</code>: Names of the models, if provided.</p></li><li><p><code>rank</code>: Ranks of the models (ordered by decreasing ELPD)</p></li><li><p><code>elpd_diff</code>: ELPD of a model subtracted from the largest ELPD of any model</p></li><li><p><code>se_elpd_diff</code>: Standard error of the ELPD difference</p></li><li><p><code>weight</code>: Model weights computed with <code>weights_method</code></p></li><li><p><code>elpd_result</code>: <code>AbstactELPDResult</code>s for each model, which can be used to access useful stats like ELPD estimates, pointwise estimates, and Pareto shape values for PSIS-LOO</p></li><li><p><code>weights_method</code>: Method used to compute model weights with <a href="#PosteriorStats.model_weights"><code>model_weights</code></a></p></li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/compare.jl#L120-L129" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.compare" id="PosteriorStats.compare"><code>PosteriorStats.compare</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compare(models; kwargs...) -&gt; ModelComparisonResult</code></pre><p>Compare models based on their expected log pointwise predictive density (ELPD).</p><p>The ELPD is estimated either by Pareto smoothed importance sampling leave-one-out cross-validation (LOO) or using the widely applicable information criterion (WAIC). <a href="#PosteriorStats.loo"><code>loo</code></a> is the default and recommended method for computing the ELPD. For more theory, see <a href="../references/#Spiegelhalter2002">Spiegelhalter <em>et al.</em> [6]</a>.</p><p><strong>Arguments</strong></p><ul><li><code>models</code>: a <code>Tuple</code>, <code>NamedTuple</code>, or <code>AbstractVector</code> whose values are either <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a> entries or any argument to <code>elpd_method</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>weights_method::AbstractModelWeightsMethod=Stacking()</code>: the method to be used to weight the models. See <a href="#PosteriorStats.model_weights"><code>model_weights</code></a> for details</li><li><code>elpd_method=loo</code>: a method that computes an <code>AbstractELPDResult</code> from an argument in <code>models</code>.</li><li><code>sort::Bool=true</code>: Whether to sort models by decreasing ELPD.</li></ul><p><strong>Returns</strong></p><ul><li><a href="#PosteriorStats.ModelComparisonResult"><code>ModelComparisonResult</code></a>: A container for the model comparison results. The fields contain a similar collection to <code>models</code>.</li></ul><p><strong>Examples</strong></p><p>Compare the centered and non centered models of the eight school problem using the defaults: <a href="#PosteriorStats.loo"><code>loo</code></a> and <a href="#PosteriorStats.Stacking"><code>Stacking</code></a> weights. A custom <code>myloo</code> method formates the inputs as expected by <a href="#PosteriorStats.loo"><code>loo</code></a>.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; models = (
           centered=load_example_data("centered_eight"),
           non_centered=load_example_data("non_centered_eight"),
       );

julia&gt; function myloo(idata)
           log_like = PermutedDimsArray(idata.log_likelihood.obs, (2, 3, 1))
           return loo(log_like)
       end;

julia&gt; mc = compare(models; elpd_method=myloo)
┌ Warning: 1 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...
ModelComparisonResult with Stacking weights
               rank  elpd  se_elpd  elpd_diff  se_elpd_diff  weight    p  se_p ⋯
 non_centered     1   -31      1.5       0            0.0       1.0  0.9  0.32 ⋯
 centered         2   -31      1.4       0.03         0.061     0.0  0.9  0.33 ⋯
julia&gt; mc.weight |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :non_centered =&gt; 1.0
  :centered     =&gt; 3.50546e-31</code></pre><p>Compare the same models from pre-computed PSIS-LOO results and computing <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> weights:</p><pre><code class="language-julia-repl hljs">julia&gt; elpd_results = mc.elpd_result;

julia&gt; compare(elpd_results; weights_method=BootstrappedPseudoBMA())
ModelComparisonResult with BootstrappedPseudoBMA weights
               rank  elpd  se_elpd  elpd_diff  se_elpd_diff  weight    p  se_p ⋯
 non_centered     1   -31      1.5       0            0.0      0.51  0.9  0.32 ⋯
 centered         2   -31      1.4       0.03         0.061    0.49  0.9  0.33 ⋯</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Spiegelhalter2002">6</a>] Spiegelhalter et al. J. R. Stat. Soc. B 64 (2002)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/compare.jl#L1-L77" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.model_weights" id="PosteriorStats.model_weights"><code>PosteriorStats.model_weights</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model_weights(elpd_results; method=Stacking())
model_weights(method::AbstractModelWeightsMethod, elpd_results)</code></pre><p>Compute weights for each model in <code>elpd_results</code> using <code>method</code>.</p><p><code>elpd_results</code> is a <code>Tuple</code>, <code>NamedTuple</code>, or <code>AbstractVector</code> with <a href="#PosteriorStats.AbstractELPDResult"><code>AbstractELPDResult</code></a> entries. The weights are returned in the same type of collection.</p><p><a href="#PosteriorStats.Stacking"><code>Stacking</code></a> is the recommended approach, as it performs well even when the true data generating process is not included among the candidate models. See <a href="../references/#Yao2018">Yao <em>et al.</em> [7]</a> for details.</p><p>See also: <a href="#PosteriorStats.AbstractModelWeightsMethod"><code>AbstractModelWeightsMethod</code></a>, <a href="#PosteriorStats.compare"><code>compare</code></a></p><p><strong>Examples</strong></p><p>Compute <a href="#PosteriorStats.Stacking"><code>Stacking</code></a> weights for two models:</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; models = (
           centered=load_example_data("centered_eight"),
           non_centered=load_example_data("non_centered_eight"),
       );

julia&gt; elpd_results = map(models) do idata
           log_like = PermutedDimsArray(idata.log_likelihood.obs, (2, 3, 1))
           return loo(log_like)
       end;
┌ Warning: 1 parameters had Pareto shape values 0.7 &lt; k ≤ 1. Resulting importance sampling estimates are likely to be unstable.
└ @ PSIS ~/.julia/packages/PSIS/...

julia&gt; model_weights(elpd_results; method=Stacking()) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :centered     =&gt; 3.50546e-31
  :non_centered =&gt; 1.0</code></pre><p>Now we compute <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> weights for the same models:</p><pre><code class="language-julia-repl hljs">julia&gt; model_weights(elpd_results; method=BootstrappedPseudoBMA()) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :centered     =&gt; 0.492513
  :non_centered =&gt; 0.507487</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Yao2018">7</a>] Yao et al. Bayesian Analysis 13, 3 (2018)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/model_weights.jl#L12-L65" target="_blank">source</a></section></article><p>The following model weighting methods are available</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.AbstractModelWeightsMethod" id="PosteriorStats.AbstractModelWeightsMethod"><code>PosteriorStats.AbstractModelWeightsMethod</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractModelWeightsMethod</code></pre><p>An abstract type representing methods for computing model weights.</p><p>Subtypes implement <a href="#PosteriorStats.model_weights"><code>model_weights</code></a><code>(method, elpd_results)</code>.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/model_weights.jl#L3" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.BootstrappedPseudoBMA" id="PosteriorStats.BootstrappedPseudoBMA"><code>PosteriorStats.BootstrappedPseudoBMA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BootstrappedPseudoBMA{R&lt;:Random.AbstractRNG, T&lt;:Real} &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting method using pseudo Bayesian Model Averaging using Akaike-type weighting with the Bayesian bootstrap (pseudo-BMA+)[<a href="../references/#Yao2018">7</a>].</p><p>The Bayesian bootstrap stabilizes the model weights.</p><pre><code class="nohighlight hljs">BootstrappedPseudoBMA(; rng=Random.default_rng(), samples=1_000, alpha=1)
BootstrappedPseudoBMA(rng, samples, alpha)</code></pre><p>Construct the method.</p><ul><li><p><code>rng::Random.AbstractRNG</code>: The random number generator to use for the Bayesian bootstrap</p></li><li><p><code>samples::Int64</code>: The number of samples to draw for bootstrapping</p></li><li><p><code>alpha::Real</code>: The shape parameter in the Dirichlet distribution used for the Bayesian bootstrap. The default (1) corresponds to a uniform distribution on the simplex.</p></li></ul><p>See also: <a href="#PosteriorStats.Stacking"><code>Stacking</code></a></p><p><strong>References</strong></p><ul><li>[<a href="../references/#Yao2018">7</a>] Yao et al. Bayesian Analysis 13, 3 (2018)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/model_weights.jl#L113" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.PseudoBMA" id="PosteriorStats.PseudoBMA"><code>PosteriorStats.PseudoBMA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct PseudoBMA &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting method using pseudo Bayesian Model Averaging (pseudo-BMA) and Akaike-type weighting.</p><pre><code class="nohighlight hljs">PseudoBMA(; regularize=false)
PseudoBMA(regularize)</code></pre><p>Construct the method with optional regularization of the weights using the standard error of the ELPD estimate.</p><div class="admonition is-info" id="Note-ae86a492058d6cc7"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ae86a492058d6cc7" title="Permalink"></a></header><div class="admonition-body"><p>This approach is not recommended, as it produces unstable weight estimates. It is recommended to instead use <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a> to stabilize the weights or <a href="#PosteriorStats.Stacking"><code>Stacking</code></a>. For details, see <a href="../references/#Yao2018">Yao <em>et al.</em> [7]</a>.</p></div></div><p>See also: <a href="#PosteriorStats.Stacking"><code>Stacking</code></a></p><p><strong>References</strong></p><ul><li>[<a href="../references/#Yao2018">7</a>] Yao et al. Bayesian Analysis 13, 3 (2018)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/model_weights.jl#L75" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.Stacking" id="PosteriorStats.Stacking"><code>PosteriorStats.Stacking</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Stacking{O&lt;:Optim.AbstractOptimizer} &lt;: AbstractModelWeightsMethod</code></pre><p>Model weighting using stacking of predictive distributions[<a href="../references/#Yao2018">7</a>].</p><pre><code class="nohighlight hljs">Stacking(; optimizer=Optim.LBFGS(), options=Optim.Options()
Stacking(optimizer[, options])</code></pre><p>Construct the method, optionally customizing the optimization.</p><ul><li><p><code>optimizer::Optim.AbstractOptimizer</code>: The optimizer to use for the optimization of the weights. The optimizer must support projected gradient optimization via a <code>manifold</code> field.</p></li><li><p><code>options::Optim.Options</code>: The Optim options to use for the optimization of the weights.</p></li></ul><p>See also: <a href="#PosteriorStats.BootstrappedPseudoBMA"><code>BootstrappedPseudoBMA</code></a></p><p><strong>References</strong></p><ul><li>[<a href="../references/#Yao2018">7</a>] Yao et al. Bayesian Analysis 13, 3 (2018)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/model_weights.jl#L175" target="_blank">source</a></section></article><h2 id="Predictive-checks"><a class="docs-heading-anchor" href="#Predictive-checks">Predictive checks</a><a id="Predictive-checks-1"></a><a class="docs-heading-anchor-permalink" href="#Predictive-checks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.loo_pit" id="PosteriorStats.loo_pit"><code>PosteriorStats.loo_pit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loo_pit(y, y_pred, log_weights; kwargs...) -&gt; Union{Real,AbstractArray}</code></pre><p>Compute leave-one-out probability integral transform (LOO-PIT) checks.</p><p><strong>Arguments</strong></p><ul><li><code>y</code>: array of observations with shape <code>(params...,)</code></li><li><code>y_pred</code>: array of posterior predictive samples with shape <code>(draws, chains, params...)</code>.</li><li><code>log_weights</code>: array of normalized log LOO importance weights with shape <code>(draws, chains, params...)</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>is_discrete</code>: If not provided, then it is set to <code>true</code> iff elements of <code>y</code> and <code>y_pred</code> are all integer-valued. If <code>true</code>, then data are smoothed using <a href="#PosteriorStats.smooth_data"><code>smooth_data</code></a> to make them non-discrete before estimating LOO-PIT values.</li><li><code>kwargs</code>: Remaining keywords are forwarded to <code>smooth_data</code> if data is discrete.</li></ul><p><strong>Returns</strong></p><ul><li><code>pitvals</code>: LOO-PIT values with same size as <code>y</code>. If <code>y</code> is a scalar, then <code>pitvals</code> is a scalar.</li></ul><p>LOO-PIT is a marginal posterior predictive check. If <span>$y_{-i}$</span> is the array <span>$y$</span> of observations with the <span>$i$</span>th observation left out, and <span>$y_i^*$</span> is a posterior prediction of the <span>$i$</span>th observation, then the LOO-PIT value for the <span>$i$</span>th observation is defined as</p><p class="math-container">\[P(y_i^* \le y_i \mid y_{-i}) = \int_{-\infty}^{y_i} p(y_i^* \mid y_{-i}) \mathrm{d} y_i^*\]</p><p>The LOO posterior predictions and the corresponding observations should have similar distributions, so if conditional predictive distributions are well-calibrated, then all LOO-PIT values should be approximately uniformly distributed on <span>$[0, 1]$</span>. [<a href="../references/#Gabry2019">8</a>]</p><p><strong>Examples</strong></p><p>Calculate LOO-PIT values using as test quantity the observed values themselves.</p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data("centered_eight");

julia&gt; y = idata.observed_data.obs;

julia&gt; y_pred = PermutedDimsArray(idata.posterior_predictive.obs, (:draw, :chain, :school));

julia&gt; log_like = PermutedDimsArray(idata.log_likelihood.obs, (:draw, :chain, :school));

julia&gt; log_weights = loo(log_like).psis_result.log_weights;

julia&gt; loo_pit(y, y_pred, log_weights)
┌ 8-element DimArray{Float64, 1} ┐
├────────────────────────────────┴─────────────────────────────── dims ┐
  ↓ school Categorical{String} ["Choate", …, "Mt. Hermon"] Unordered
└──────────────────────────────────────────────────────────────────────┘
 "Choate"            0.942759
 "Deerfield"         0.641057
 "Phillips Andover"  0.32729
 "Phillips Exeter"   0.581451
 "Hotchkiss"         0.288523
 "Lawrenceville"     0.393741
 "St. Paul's"        0.886175
 "Mt. Hermon"        0.638821</code></pre><p>Calculate LOO-PIT values using as test quantity the square of the difference between each observation and <code>mu</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; using Statistics

julia&gt; mu = idata.posterior.mu;

julia&gt; T = y .- median(mu);

julia&gt; T_pred = y_pred .- mu;

julia&gt; loo_pit(T .^ 2, T_pred .^ 2, log_weights)
┌ 8-element DimArray{Float64, 1} ┐
├────────────────────────────────┴─────────────────────────────── dims ┐
  ↓ school Categorical{String} ["Choate", …, "Mt. Hermon"] Unordered
└──────────────────────────────────────────────────────────────────────┘
 "Choate"            0.868148
 "Deerfield"         0.27421
 "Phillips Andover"  0.321719
 "Phillips Exeter"   0.193169
 "Hotchkiss"         0.370422
 "Lawrenceville"     0.195601
 "St. Paul's"        0.817408
 "Mt. Hermon"        0.326795</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Gabry2019">8</a>] Gabry et al. J. R. Stat. Soc. Ser. A Stat. Soc. 182 (2019).</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/loo_pit.jl#L1-L100" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.r2_score" id="PosteriorStats.r2_score"><code>PosteriorStats.r2_score</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r2_score(y_true::AbstractVector, y_pred::AbstractArray) -&gt; (; r2, r2_std)</code></pre><p><span>$R²$</span> for linear Bayesian regression models.[<a href="../references/#Gelman2019">9</a>]</p><p><strong>Arguments</strong></p><ul><li><code>y_true</code>: Observed data of length <code>noutputs</code></li><li><code>y_pred</code>: Predicted data with size <code>(ndraws[, nchains], noutputs)</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using ArviZExampleData

julia&gt; idata = load_example_data("regression1d");

julia&gt; y_true = idata.observed_data.y;

julia&gt; y_pred = PermutedDimsArray(idata.posterior_predictive.y, (:draw, :chain, :y_dim_0));

julia&gt; r2_score(y_true, y_pred) |&gt; pairs
pairs(::NamedTuple) with 2 entries:
  :r2     =&gt; 0.683197
  :r2_std =&gt; 0.0368838</code></pre><p><strong>References</strong></p><ul><li>[<a href="../references/#Gelman2019">9</a>] Gelman et al, The Am. Stat., 73(3) (2019)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/r2_score.jl#L1-L31" target="_blank">source</a></section></article><h3 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.kde_reflected" id="PosteriorStats.kde_reflected"><code>PosteriorStats.kde_reflected</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kde_reflected(data::AbstractVector{&lt;:Real}; bounds=extrema(data), kwargs...)</code></pre><p>Compute the boundary-corrected kernel density estimate (KDE) of <code>data</code> using reflection.</p><p>For <span>$x \in (l, u)$</span>, the reflected KDE has the density</p><p class="math-container">\[\hat{f}_R(x) = \hat{f}(x) + \hat{f}(2l - x) + \hat{f}(2u - x),\]</p><p>where <span>$\hat{f}$</span> is the usual KDE of <code>data</code>. This is equivalent to augmenting the original data with 2 additional copies of the data reflected around each bound, computing the usual KDE, trimming the KDE to the bounds, and renormalizing.</p><p>Any non-finite <code>bounds</code> are ignored. Remaining <code>kwargs</code> are passed to <code>KernelDensity.kde</code>. The default bandwidth is estimated using the Improved Sheather-Jones (ISJ) method [<a href="../references/#Botev2010">10</a>].</p><p><strong>References</strong></p><ul><li>[<a href="../references/#Botev2010">10</a>] Botev et al. Ann. Stat., 38: 5 (2010)</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/kde.jl#L90-L110" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.pointwise_loglikelihoods" id="PosteriorStats.pointwise_loglikelihoods"><code>PosteriorStats.pointwise_loglikelihoods</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pointwise_loglikelihoods</code></pre><p>Compute pointwise conditional log-likelihoods for ELPD-based model comparison/validation.</p><p>Given model parameters <span>$\theta$</span> and observations <span>$y$</span>, the pointwise conditional log-likelihood of <span>$y_i$</span> given <span>$y_{-i}$</span> (the elements of <span>$y$</span> excluding <span>$y_i$</span>) and <span>$\theta$</span> is defined as</p><p class="math-container">\[\log p(y_i \mid y_{-i}, \theta)\]</p><p>This method is a utility function that dependant packages can override to provide pointwise conditional log-likelihoods for their own models/distributions.</p><p>See also: <a href="#PosteriorStats.loo"><code>loo</code></a></p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/pointwise_loglikelihoods.jl#L1-L17" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.pointwise_loglikelihoods-Union{Tuple{N}, Tuple{M}, Tuple{AbstractArray{&lt;:Real, N}, AbstractArray{&lt;:Distribution{&lt;:ArrayLikeVariate{N}}, M}}} where {M, N}" id="PosteriorStats.pointwise_loglikelihoods-Union{Tuple{N}, Tuple{M}, Tuple{AbstractArray{&lt;:Real, N}, AbstractArray{&lt;:Distribution{&lt;:ArrayLikeVariate{N}}, M}}} where {M, N}"><code>PosteriorStats.pointwise_loglikelihoods</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pointwise_loglikelihoods(y, dists)</code></pre><p>Compute pointwise conditional log-likelihoods of <code>y</code> for non-factorized distributions.</p><p>A non-factorized observation model <span>$p(y \mid \theta)$</span>, where <span>$y$</span> is an array of observations and <span>$\theta$</span> are model parameters, can be factorized as <span>$p(y_i \mid y_{-i}, \theta) p(y_{-i} \mid \theta)$</span>. However, completely factorizing into individual likelihood terms can be tedious, expensive, and poorly supported by a given PPL. This utility function computes <span>$\log p(y_i \mid y_{-i}, \theta)$</span> terms for all <span>$i$</span>; the resulting pointwise conditional log-likelihoods can be used e.g. in <a href="#PosteriorStats.loo"><code>loo</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>y</code>: array of observations with shape <code>(params...,)</code></li><li><code>dists</code>: array of shape <code>(draws[, chains])</code> containing parametrized <code>Distributions.Distribution</code>s representing a non-factorized observation model, one for each posterior draw. The following distributions are currently supported:<ul><li><a href="https://juliastats.org/Distributions.jl/stable/multivariate/#Distributions.MvNormal"><code>Distributions.MvNormal</code></a> [<a href="../references/#Burkner2021">11</a>]</li><li><a href="https://juliastats.org/Distributions.jl/stable/multivariate/#Distributions.MvNormalCanon"><code>Distributions.MvNormalCanon</code></a></li><li><a href="https://juliastats.org/Distributions.jl/stable/matrix/#Distributions.MatrixNormal"><code>Distributions.MatrixNormal</code></a></li><li><a href="https://juliastats.org/Distributions.jl/stable/multivariate/#Distributions.MvLogNormal"><code>Distributions.MvLogNormal</code></a></li><li><code>Distributions.GenericMvTDist</code> [<a href="../references/#Burkner2021">11</a>, but uses a more efficient implementation]</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>log_like</code>: log-likelihood values with shape <code>(draws[, chains], params...)</code></li></ul><p><strong>References</strong></p><ul><li>[<a href="../references/#Burkner2021">11</a>] Bürkner et al. Comput. Stat. 36 (2021).</li><li>[<a href="../references/#LOOFactorized">12</a>] Vehtari et al. Leave-one-out cross-validation for non-factorized   models</li></ul></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/pointwise_loglikelihoods.jl#L20-L54" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#PosteriorStats.smooth_data" id="PosteriorStats.smooth_data"><code>PosteriorStats.smooth_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">smooth_data(y; dims=:, interp_method=CubicSpline, offset_frac=0.01)</code></pre><p>Smooth <code>y</code> along <code>dims</code> using <code>interp_method</code>.</p><p><code>interp_method</code> is a 2-argument callabale that takes the arguments <code>y</code> and <code>x</code> and returns a DataInterpolations.jl interpolation method, defaulting to a cubic spline interpolator.</p><p><code>offset_frac</code> is the fraction of the length of <code>y</code> to use as an offset when interpolating.</p></div><a class="docs-sourcelink" href="https://github.com/arviz-devs/PosteriorStats.jl/blob/0780d5d497904f145eb15c7ae06f254bca10c01b/src/utils.jl#L8-L17" target="_blank">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 26 August 2025 12:35">Tuesday 26 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>